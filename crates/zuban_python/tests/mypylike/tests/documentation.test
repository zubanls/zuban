[case docs_simple]
class A:
    """ a doc """
class B:
    """ b doc """

def f(x: A | B, a: A):
    #? documentation
    x
    #? documentation
    a
    #? documentation --only-docstrings
    a

#? --codepoint-column 1 documentation
x = 1
#? documentation
x
#? documentation
1

[out]
__main__.py:8:documentation -> "```python\n(param) x: A | B\n```\n---\na doc\n\nb doc"
__main__.py:10:documentation -> "```python\n(param) a: A\n```\n---\na doc"
__main__.py:12:documentation -> "a doc"
__main__.py:15:documentation -> "```python\n(variable) x: int\n```"
__main__.py:17:documentation -> "```python\n(variable) x: int\n```"
__main__.py:19:documentation -> No docs found

[case docs_class]
#? --codepoint-column 6 documentation
class WithGeneric[T]:
    """
    with docs
    """
#? --codepoint-column 6 documentation
class WithoutGeneric:
    """
    without docs
    """

#? documentation
WithGeneric
#? documentation
WithoutGeneric

[out]
__main__.py:2:documentation -> "```python\n(class) WithGeneric() -> WithGeneric[T]\n```\n---\nwith docs"
__main__.py:7:documentation -> "```python\n(class) WithoutGeneric() -> WithoutGeneric\n```\n---\nwithout docs"
__main__.py:13:documentation -> "```python\n(class) WithGeneric() -> WithGeneric[T]\n```\n---\nwith docs"
__main__.py:15:documentation -> "```python\n(class) WithoutGeneric() -> WithoutGeneric\n```\n---\nwithout docs"

[case docs_alias]

#? --codepoint-column 7 documentation
type Alias = int
#? --codepoint-column 15 documentation
def foo() -> Alias: ...

#? --codepoint-column 7 documentation
OtherAlias = str

#? --codepoint-column 15 documentation
def bar() -> OtherAlias: ...

[out]
__main__.py:3:documentation -> "```python\n(type) Alias = int"
__main__.py:5:documentation -> "```python\n(type) Alias = int"
__main__.py:8:documentation -> "```python\n(variable) OtherAlias: type[str]"
__main__.py:11:documentation -> "```python\n(variable) OtherAlias: type[str]"

[case docs_function_mypy_compatible]
# flags: --mypy-compatible
#? --codepoint-column 6 documentation
def typed[T](x: list[T]) -> T:
    " typed doc "
    return x[0]
#? --codepoint-column 4 documentation
def untyped(x):
    " untyped doc "
    return x

#? documentation
typed
#? documentation
untyped

[out]
__main__.py:3:documentation -> "```python\n(function) def [T] typed(x: list[T]) -> T\n```\n---\ntyped doc"
__main__.py:7:documentation -> "```python\n(function) def untyped(x: Any) -> Any\n```\n---\nuntyped doc"
__main__.py:12:documentation -> "```python\n(function) def [T] typed(x: list[T]) -> T\n```\n---\ntyped doc"
__main__.py:14:documentation -> "```python\n(function) def untyped(x: Any) -> Any\n```\n---\nuntyped doc"

[case docs_function_no_mypy_compatible]
# flags: --no-mypy-compatible
#? --codepoint-column 6 documentation
def typed[T](x: list[T]) -> T:
    " typed doc "
    return x[0]
#? --codepoint-column 4 documentation
def untyped(x):
    " untyped doc "
    return x

#? documentation
typed
#? documentation
untyped

[out]
__main__.py:3:documentation -> "```python\n(function) def [T] typed(x: list[T]) -> T\n```\n---\ntyped doc"
__main__.py:7:documentation -> "```python\n(function) def [T1: Any] untyped(x: T1) -> T1\n```\n---\nuntyped doc"
__main__.py:12:documentation -> "```python\n(function) def [T] typed(x: list[T]) -> T\n```\n---\ntyped doc"
__main__.py:14:documentation -> "```python\n(function) def [T1: Any] untyped(x: T1) -> T1\n```\n---\nuntyped doc"

[case docs_property]
class X:
    #? --codepoint-column 9 documentation
    def func[T](self, x: list[T]) -> T:
        " func doc "
        return x[0]

    @property
    #? --codepoint-column 9 documentation
    def prop(self) -> int:
        " property doc "
        return 1

#? documentation
X.func
#? documentation
X().func
#? documentation
X.prop
#? documentation
X().prop

[out]
__main__.py:3:documentation -> "```python\n(function) def [T] func(self, x: list[T]) -> T\n```\n---\nfunc doc"
__main__.py:9:documentation -> "```python\n(property) def prop(self) -> int\n```\n---\nproperty doc"
__main__.py:14:documentation -> "```python\n(function) def [T] func(self, x: list[T]) -> T\n```\n---\nfunc doc"
__main__.py:16:documentation -> "```python\n(function) def [T] func(x: list[T]) -> T\n```\n---\nfunc doc"
__main__.py:18:documentation -> "```python\n(function) prop: property\n```"
__main__.py:20:documentation -> "```python\n(property) prop: int\n```"

[case docs_classmethod_staticmethod]
class X:
    @classmethod
    #? --codepoint-column 9 documentation
    def classm(cls) -> int:
        " classm doc "
        return 1

    @staticmethod
    #? --codepoint-column 9 documentation
    def staticm(x: str) -> int:
        " staticm doc "
        return 1

#? documentation
X.classm
#? documentation
X().classm
#? documentation
X.staticm
#? documentation
X().staticm

[out]
__main__.py:4:documentation -> "```python\n(function) def classm(cls, cls) -> int\n```\n---\nclassm doc"
__main__.py:10:documentation -> "```python\n(function) def staticm(x: str) -> int\n```\n---\nstaticm doc"
__main__.py:15:documentation -> "```python\n(function) def classm(cls) -> int\n```\n---\nclassm doc"
__main__.py:17:documentation -> "```python\n(function) def classm(cls) -> int\n```\n---\nclassm doc"
__main__.py:19:documentation -> "```python\n(function) def staticm(x: str) -> int\n```\n---\nstaticm doc"
__main__.py:21:documentation -> "```python\n(function) def staticm(x: str) -> int\n```\n---\nstaticm doc"

[case docs_goto_on_operator]
class X:
    def __eq__(self, other: object) -> bool:
        """Hello world"""
        return True

    def __and__(self, other: X) -> X:
        return self

def foo(a: X, b: X):
    #? --codepoint-column 7 documentation
    a == b
    #? --codepoint-column 7 documentation
    a & b
    #? --codepoint-column 7 documentation
    1 | 1

[out]
__main__.py:11:documentation -> "```python\n(function) def __eq__(other: object) -> bool\n```\n---\nHello world"
__main__.py:13:documentation -> "```python\n(function) def __and__(other: X) -> X\n```"
__main__.py:15:documentation -> "```python\n(function) def __or__(int, /) -> int\n```"

[case docs_on_overload]
# From GH #162
from typing import overload

@overload
def f(x: int) -> int: ...

@overload
def f(x: str) -> str: ...
def f(x: str | int) -> str | int: ...

#? --codepoint-column 0 documentation
f(1)

[out]
__main__.py:12:documentation -> "```python\n(function) Overload(\n    def f(x: int) -> int,\n    def f(x: str) -> str\n)\n```"

[case docs_on_type_of_class]
from dataclasses import dataclass
class A:
    """ a doc """
    def __init__(self, a: int, *, a2: str): ...
class B: pass
@dataclass
class D:
    x: int
    y: str = ""

#? documentation
A
#? documentation
B
#? documentation
D

[out]
__main__.py:12:documentation -> "```python\n(class) A(a, *, a2: str) -> A\n```\n---\na doc"
__main__.py:14:documentation -> "```python\n(class) B() -> B\n```"
__main__.py:16:documentation -> "```python\n(class) D(x: int, y: str = ...) -> D\n```"

[case documentation_doctests_formatting]
def f() -> None:
    """
    asdf
    >>> bla
    foo
    >>> 1
    bar

    x
    
    >>> hello
    """

#? documentation
f

[out]
__main__.py:15:documentation -> "```python\n(function) def f() -> None\n```\n---\nasdf\n```python\n>>> bla\nfoo\n>>> 1\nbar\n```\n\nx\n\n```python\n>>> hello\n```\n"
